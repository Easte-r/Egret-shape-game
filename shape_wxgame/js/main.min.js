var egret=window.egret,__reflect=this&&this.__reflect||function(t,e,i){t.__class__=e,i?i.push(e):i=[e],t.__types__=t.__types__?i.concat(t.__types__):i},__extends=this&&this.__extends||function(t,e){function i(){this.constructor=t}for(var n in e)e.hasOwnProperty(n)&&(t[n]=e[n]);i.prototype=e.prototype,t.prototype=new i},__awaiter=this&&this.__awaiter||function(t,e,i,n){return new(i||(i=Promise))(function(r,s){function o(t){try{h(n.next(t))}catch(e){s(e)}}function a(t){try{h(n["throw"](t))}catch(e){s(e)}}function h(t){t.done?r(t.value):new i(function(e){e(t.value)}).then(o,a)}h((n=n.apply(t,e||[])).next())})},__generator=this&&this.__generator||function(t,e){function i(t){return function(e){return n([t,e])}}function n(i){if(r)throw new TypeError("Generator is already executing.");for(;h;)try{if(r=1,s&&(o=s[2&i[0]?"return":i[0]?"throw":"next"])&&!(o=o.call(s,i[1])).done)return o;switch(s=0,o&&(i=[0,o.value]),i[0]){case 0:case 1:o=i;break;case 4:return h.label++,{value:i[1],done:!1};case 5:h.label++,s=i[1],i=[0];continue;case 7:i=h.ops.pop(),h.trys.pop();continue;default:if(o=h.trys,!(o=o.length>0&&o[o.length-1])&&(6===i[0]||2===i[0])){h=0;continue}if(3===i[0]&&(!o||i[1]>o[0]&&i[1]<o[3])){h.label=i[1];break}if(6===i[0]&&h.label<o[1]){h.label=o[1],o=i;break}if(o&&h.label<o[2]){h.label=o[2],h.ops.push(i);break}o[2]&&h.ops.pop(),h.trys.pop();continue}i=e.call(t,h)}catch(n){i=[6,n],s=0}finally{r=o=0}if(5&i[0])throw i[1];return{value:i[0]?i[1]:void 0,done:!0}}var r,s,o,a,h={label:0,sent:function(){if(1&o[0])throw o[1];return o[1]},trys:[],ops:[]};return a={next:i(0),"throw":i(1),"return":i(2)},"function"==typeof Symbol&&(a[Symbol.iterator]=function(){return this}),a},BaseDisplayOC=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.remove,e),e}return __extends(e,t),e.prototype.init=function(){console.log("11")},e.prototype.remove=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.remove,this)},e}(egret.DisplayObjectContainer);__reflect(BaseDisplayOC.prototype,"BaseDisplayOC");var BaseSprite=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.remove,e),e}return __extends(e,t),e.prototype.init=function(){console.log("11")},e.prototype.remove=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.remove,this)},e}(egret.Sprite);__reflect(BaseSprite.prototype,"BaseSprite");var BaseUILayer=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.remove,e),e}return __extends(e,t),e.prototype.init=function(){console.log("11")},e.prototype.remove=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.remove,this)},e}(eui.UILayer);__reflect(BaseUILayer.prototype,"BaseUILayer");var NetBitmap=function(t){function e(e){var i=t.call(this)||this,n=new egret.ImageLoader;return n.crossOrigin="anonymous",n.once(egret.Event.COMPLETE,i.imgLoadHandler,i),n.load(e),i}return __extends(e,t),e.prototype.imgLoadHandler=function(t){var e=t.currentTarget,i=e.data,n=new egret.Texture;n._setBitmapData(i),this.texture=n},e}(egret.Bitmap);__reflect(NetBitmap.prototype,"NetBitmap");var DebugPlatform=function(){function t(){this.openDataContext={createDisplayObject:function(){},postMessage:function(){}},this.userInfo=null,this.feedBackBtn=null}return t.prototype.getUserInfo=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2,{nickName:"username"}]})})},t.prototype.login=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.openCustomerServiceConversation=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t.prototype.showShareMenu=function(t){},t.prototype.shareToFriend=function(t){},t.prototype.shake=function(t){},t.prototype.playAudio=function(t){},t.prototype.createFeedbackButton=function(){},t.prototype.hideFeedBack=function(){},t.prototype.showFeedBack=function(){},t.prototype.setToStorage=function(t,e){},t.prototype.getFromStorage=function(t){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){return[2]})})},t}();__reflect(DebugPlatform.prototype,"DebugPlatform",["Platform"]),window.platform||(window.platform=new DebugPlatform);var ThemeAdapter=function(){function t(){}return t.prototype.getTheme=function(t,e,i,n){function r(t){e.call(n,t)}function s(e){e.resItem.url==t&&(RES.removeEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),i.call(n))}var o=this;if("undefined"!=typeof generateEUI)egret.callLater(function(){e.call(n,generateEUI)},this);else if("undefined"!=typeof generateEUI2)RES.getResByUrl("resource/gameEui.json",function(t,i){window.JSONParseClass.setData(t),egret.callLater(function(){e.call(n,generateEUI2)},o)},this,RES.ResourceItem.TYPE_JSON);else if("undefined"!=typeof generateJSON)if(t.indexOf(".exml")>-1){var a=t.split("/");a.pop();var h=a.join("/")+"_EUI.json";generateJSON.paths[t]?egret.callLater(function(){e.call(n,generateJSON.paths[t])},this):RES.getResByUrl(h,function(i){window.JSONParseClass.setData(i),egret.callLater(function(){e.call(n,generateJSON.paths[t])},o)},this,RES.ResourceItem.TYPE_JSON)}else egret.callLater(function(){e.call(n,generateJSON)},this);else RES.addEventListener(RES.ResourceEvent.ITEM_LOAD_ERROR,s,null),RES.getResByUrl(t,r,this,RES.ResourceItem.TYPE_TEXT)},t}();__reflect(ThemeAdapter.prototype,"ThemeAdapter",["eui.IThemeAdapter"]);var GameScene=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){console.log("GameScene主场景加载"),this.width=this.stage.stageWidth,this.height=this.stage.stageHeight,this.bg=new BackgroundContainer,this.addChild(this.bg),this.gc=new GameContainer,this.addChild(this.gc),this.pc=new PopContainer,this.addChild(this.pc)},e}(BaseDisplayOC);__reflect(GameScene.prototype,"GameScene");var BaseEUIGroup=function(t){function e(){var e=t.call(this)||this;return e.addEventListener(egret.Event.ADDED_TO_STAGE,e.init,e),e.addEventListener(egret.Event.REMOVED_FROM_STAGE,e.remove,e),e}return __extends(e,t),e.prototype.init=function(){console.log("11")},e.prototype.remove=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.remove,this)},e}(eui.Group);__reflect(BaseEUIGroup.prototype,"BaseEUIGroup");var BaseShape=function(t){function e(e,i){var n=t.call(this)||this;return n.width=e,n.height=i,n.addEventListener(egret.Event.ADDED_TO_STAGE,n.init,n),n.addEventListener(egret.Event.REMOVED_FROM_STAGE,n.remove,n),n}return __extends(e,t),e.prototype.init=function(){},e.prototype.remove=function(){this.removeEventListener(egret.Event.ADDED_TO_STAGE,this.init,this),this.removeEventListener(egret.Event.REMOVED_FROM_STAGE,this.remove,this)},e}(egret.Shape);__reflect(BaseShape.prototype,"BaseShape");var AssetAdapter=function(){function t(){}return t.prototype.getAsset=function(t,e,i){function n(n){e.call(i,n,t)}if(RES.hasRes(t)){var r=RES.getRes(t);r?n(r):RES.getResAsync(t,n,this)}else RES.getResByUrl(t,n,this,RES.ResourceItem.TYPE_IMAGE)},t}();__reflect(AssetAdapter.prototype,"AssetAdapter",["eui.IAssetAdapter"]);var LoadingUI=function(t){function e(){var e=t.call(this)||this;return e.w=580,e.r=8,e.once(egret.Event.ADDED_TO_STAGE,e.createView,e),e}return __extends(e,t),e.prototype.createView=function(){var t=this.stage.stageWidth,e=this.stage.stageHeight,i=new egret.Shape;i.graphics.beginFill(8566783),i.graphics.drawRect(0,0,t,e),i.graphics.endFill(),this.addChild(i);var n=this.r,r=this.w,s=new egret.Shape;s.width=r,s.height=2*n,s.x=(this.stage.stageWidth-s.width)/2,s.y=this.stage.stageHeight/2,s.graphics.beginFill(14540253,.3),s.graphics.moveTo(n,0),s.graphics.lineTo(r-n,0),s.graphics.drawArc(r-n,n,n,-Math.PI/2,Math.PI/2),s.graphics.lineTo(n,2*n),s.graphics.drawArc(n,n,n,Math.PI/2,-Math.PI/2),s.graphics.lineTo(n,0),s.graphics.endFill(),this.addChild(s);var o=new egret.Shape;o.width=r,o.height=2*n,o.x=(this.stage.stageWidth-o.width)/2,o.y=this.stage.stageHeight/2,o.graphics.beginFill(3536895),o.graphics.moveTo(n,0),o.graphics.lineTo(r-n,0),o.graphics.drawArc(r-n,n,n,-Math.PI/2,Math.PI/2),o.graphics.lineTo(n,2*n),o.graphics.drawArc(n,n,n,Math.PI/2,-Math.PI/2),o.graphics.lineTo(n,0),o.graphics.endFill(),this.addChild(o),this.shapeProgress=new egret.Sprite,this.shapeProgress.width=r,this.shapeProgress.height=2*n,this.shapeProgress.anchorOffsetX=this.shapeProgress.width,this.shapeProgress.x=(this.stage.stageWidth-this.shapeProgress.width)/2,this.shapeProgress.y=this.stage.stageHeight/2,this.shapeProgress.graphics.beginFill(16777215),this.shapeProgress.graphics.moveTo(n,0),this.shapeProgress.graphics.lineTo(r-n,0),this.shapeProgress.graphics.drawArc(r-n,n,n,-Math.PI/2,Math.PI/2),this.shapeProgress.graphics.lineTo(n,2*n),this.shapeProgress.graphics.drawArc(n,n,n,Math.PI/2,-Math.PI/2),this.shapeProgress.graphics.lineTo(n,0),this.shapeProgress.graphics.endFill(),this.shapeProgress.mask=o,this.addChild(this.shapeProgress),this.textField=new egret.TextField,this.addChild(this.textField),this.textField.y=this.stage.stageHeight/2-50,this.textField.width=this.stage.stageWidth,this.textField.height=50,this.textField.textAlign="center",this.textField.text="资源加载中...";var a="抵制不良游戏，拒绝盗版游戏\n注意自我保护，谨防受骗上当\n适度游戏益脑，沉迷游戏伤身\n合理安排时间，享受健康生活";this.textHint=new egret.TextField,this.textHint.lineSpacing=15,this.textHint.text=a,this.textHint.size=30,this.textHint.textColor=15658734,this.textHint.x=(this.stage.stageWidth-this.textHint.width)/2,this.textHint.y=this.stage.stageHeight-250,this.addChild(this.textHint)},e.prototype.onProgress=function(t,e){var i=t*this.w/e;this.shapeProgress.x=i+(this.stage.stageWidth-this.shapeProgress.width)/2},e}(egret.Sprite);__reflect(LoadingUI.prototype,"LoadingUI",["RES.PromiseTaskReporter"]);var Main=function(t){function e(){return null!==t&&t.apply(this,arguments)||this}return __extends(e,t),e.prototype.createChildren=function(){t.prototype.createChildren.call(this),egret.lifecycle.addLifecycleListener(function(t){}),egret.lifecycle.onPause=function(){egret.ticker.pause()},egret.lifecycle.onResume=function(){egret.ticker.resume()};var e=new AssetAdapter;egret.registerImplementation("eui.IAssetAdapter",e),egret.registerImplementation("eui.IThemeAdapter",new ThemeAdapter),this.runGame()["catch"](function(t){console.log(t)})},e.prototype.runGame=function(){return __awaiter(this,void 0,void 0,function(){return __generator(this,function(t){switch(t.label){case 0:return[4,this.loadResource()];case 1:return t.sent(),this.createGameScene(),[2]}})})},e.prototype.loadResource=function(){return __awaiter(this,void 0,void 0,function(){var t,e;return __generator(this,function(i){switch(i.label){case 0:return i.trys.push([0,4,,5]),RES.setMaxLoadingThread(1),[4,RES.loadConfig("resource/default.res.json","resource/")];case 1:return i.sent(),[4,this.loadTheme()];case 2:return i.sent(),t=new LoadingUI,this.stage.addChild(t),[4,RES.loadGroup("preload",1,t)];case 3:return i.sent(),this.stage.removeChild(t),platform.openDataContext.postMessage({command:"loadRes"}),[3,5];case 4:return e=i.sent(),console.error(e),[3,5];case 5:return[2]}})})},e.prototype.loadTheme=function(){var t=this;return new Promise(function(e,i){var n=new eui.Theme("resource/default.thm.json",t.stage);n.addEventListener(eui.UIEvent.COMPLETE,function(){e()},t)})},e.prototype.createGameScene=function(){var t=this;Data.i().toast=new Toast,platform.getFromStorage("_KEY_GRADE_").then(function(e){console.log("_KEY_GRADE_",e.data),""!=e.data&&(Data.i().grade=Number(e.data)),t.addChild(new GameScene),t.addChild(Data.i().toast)})["catch"](function(){t.addChild(new GameScene),t.addChild(Data.i().toast)});var e=["jump_wav","tap1_mp3","gameover_wav"];Data.i().sound=new SoundContainer(e),platform.showShareMenu({})},e}(eui.UILayer);__reflect(Main.prototype,"Main");var Util=function(){function t(){}return t.createBitmapByName=function(t){var e=new egret.Bitmap,i=RES.getRes(t);return e.texture=i,e},t}();__reflect(Util.prototype,"Util");var SoundContainer=function(){function t(t){this.soundArr={},this.arr=[],this.arr=t,this.init()}return t.prototype.init=function(){for(var t=0;t<this.arr.length;t++)this.soundArr[this.arr[t]]=new Sound(this.arr[t])},t.prototype.getSound=function(t){return this.soundArr[t]},t}();__reflect(SoundContainer.prototype,"SoundContainer");var Sound=function(){function t(t){this.sound=RES.getRes(t)}return t.prototype.play=function(){this.soundChanner=this.sound.play(0,1)},t.prototype.stop=function(){this.soundChanner.stop()},t}();__reflect(Sound.prototype,"Sound");var Toast=function(t){function e(){var e=t.call(this)||this;return e.toastArr=[],e.touchThrough=!0,e}return __extends(e,t),e.prototype.init=function(){},e.prototype.Toast=function(t,e){var i=new ToastChild(t,e);this.addChild(i)},e}(BaseUILayer);__reflect(Toast.prototype,"Toast");var ToastChild=function(t){function e(e,i){var n=t.call(this)||this;return n.text="",n.size=28,n.time=2e3,n.text=e,i&&(n.time=i),n}return __extends(e,t),e.prototype.init=function(){var t=this;this.alpha=0;var e=this.stage.stageWidth,i=this.stage.stageHeight;this.width=this.text.length*this.size+60,this.height=this.size+60,this.graphics.beginFill(16777215,.8),this.graphics.drawRoundRect(0,0,this.width,this.height,30),this.graphics.endFill(),this.x=(e-this.width)/2,this.y=(i-this.height)/2+80;var n=new egret.TextField;n.size=this.size,n.text=this.text,n.textColor=0,n.width=this.width,n.height=this.height,n.textAlign=egret.HorizontalAlign.CENTER,n.verticalAlign=egret.VerticalAlign.MIDDLE,this.addChild(n),egret.Tween.get(this).to({y:(i-this.height)/2,alpha:1},300).wait(this.time).to({alpha:0,y:(i-this.height)/2-20},300).call(function(){egret.Tween.removeTweens(t),t.parent.removeChild(t)})},e}(BaseSprite);__reflect(ToastChild.prototype,"ToastChild");var GameEvent=function(t){function e(e,i,n){void 0===i&&(i=!1),void 0===n&&(n=!1);var r=t.call(this,e,i,n)||this;return r._year=0,r}return __extends(e,t),e.DATE="事件名字",e.changeScene="changeScene",e}(egret.Event);__reflect(GameEvent.prototype,"GameEvent");var Data=function(t){function e(){var e=null!==t&&t.apply(this,arguments)||this;return e.toast=null,e.grade=750,e}return __extends(e,t),e.i=function(){return this.data?this.data:(this.data=new e,this.data)},e.prototype.Toast=function(t,e){this.toast.Toast(t,e)},e.prototype.Sound=function(t){return this.sound.getSound(t)},e.data=null,e}(egret.EventDispatcher);__reflect(Data.prototype,"Data");var BackgroundContainer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){console.log("BackgroundContainer已加载");var t=new egret.Bitmap(RES.getRes("home_bg_jpg"));t.width=this.stage.stageWidth,t.height=this.stage.stageHeight,this.addChild(t)},e}(BaseUILayer);__reflect(BackgroundContainer.prototype,"BackgroundContainer");var Game=function(t){function e(e){var i=t.call(this)||this;return i._GameContainer=e,i}return __extends(e,t),e.prototype.init=function(){},e}(BaseUILayer);__reflect(Game.prototype,"Game");var GameContainer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){console.log("GameContainer已加载"),this.home=new Home(this),this.addChild(this.home)},e.prototype.createGame=function(){this.contains(this.game)&&this.removeChild(this.game),this.game=new Game(this),this.addChild(this.game)},e.prototype.createHome=function(){this.contains(this.home)&&this.removeChild(this.home),this.home=new Home(this),this.addChild(this.home)},e}(BaseUILayer);__reflect(GameContainer.prototype,"GameContainer");var Home=function(t){function e(e){var i=t.call(this)||this;return i._GameContainer=e,i}return __extends(e,t),e.prototype.init=function(){var t=this.stage.stageWidth,e=this.stage.stageHeight,i=new egret.Shape;i.graphics.beginFill(16777215),i.graphics.drawCircle(t/2,250,72),i.graphics.endFill(),this.addChild(i),this.logo=Util.createBitmapByName("logo_png"),this.logo.anchorOffsetX=this.logo.width/2,this.logo.anchorOffsetY=this.logo.height/2,this.logo.y=250,this.logo.x=t/2,this.addChild(this.logo),this.logo.mask=i;var n=6,r=45,s=0,o=.7,a=16,h=16,c=.65,l=1,u=!1,p=!1,g=new egret.DropShadowFilter(n,r,s,o,a,h,c,l,u,p);this.logo.filters=[g],this.title=Util.createBitmapByName("title_png"),this.title.anchorOffsetX=this.title.width/2,this.title.anchorOffsetY=this.title.height/2,this.title.y=500,this.title.x=t/2,this.title.scaleX=1.2,this.title.scaleY=1.2,this.addChild(this.title),this.title.filters=[g],this.play=Util.createBitmapByName("play_png"),this.play.anchorOffsetX=this.play.width/2,this.play.anchorOffsetY=this.play.height/2,this.play.y=e-300,this.play.x=t/2,this.play.scaleX=.7,this.play.scaleY=.7,this.play.touchEnabled=!0,this.addChild(this.play),this.play.filters=[g];var d=RES.getRes("snow_png"),f=RES.getRes("snow_json");this.system=new particle.GravityParticleSystem(d,f),this.addChildAt(this.system,0),this.system.start(),this.music=Util.createBitmapByName("music_open_png"),this.music.width=80,this.music.height=80,this.music.anchorOffsetX=this.music.width/2,this.music.anchorOffsetY=this.music.height/2,this.music.y=60,this.music.x=60,this.music.touchEnabled=!0,this.addChild(this.music),this.music.filters=[g],egret.Tween.get(this.title,{loop:!0}).to({y:520},3e3,egret.Ease.sineInOut).to({y:500},3e3,egret.Ease.sineInOut),egret.Tween.get(this.play,{loop:!0}).wait(8e3).to({rotation:360},400,egret.Ease.sineInOut).to({scaleX:.78,scaleY:.78},80).to({scaleX:.7,scaleY:.7},80).to({scaleX:.78,scaleY:.78},80).to({scaleX:.7,scaleY:.7},80),this.play.addEventListener(egret.TouchEvent.TOUCH_TAP,this.playTap,this),this.music.addEventListener(egret.TouchEvent.TOUCH_BEGIN,this.musicBegin,this)},e.prototype.playTap=function(){egret.Tween.removeTweens(this.play),egret.Tween.removeTweens(this.title),this.removeChildren(),this.parent.removeChild(this),this._GameContainer.createGame()},e.prototype.musicBegin=function(){this.music.scaleX=.93,this.music.scaleY=.93,this.music.addEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.musicEnd,this),this.music.addEventListener(egret.TouchEvent.TOUCH_END,this.musicEnd,this)},e.prototype.musicEnd=function(t){var e=this;this.music.removeEventListener(egret.TouchEvent.TOUCH_RELEASE_OUTSIDE,this.musicEnd,this),this.music.removeEventListener(egret.TouchEvent.TOUCH_END,this.musicEnd,this),this.music.scaleX=1,this.music.scaleY=1,t.type==egret.TouchEvent.TOUCH_TAP&&setTimeout(function(){e.removeChildren(),e.parent.removeChild(e),e._GameContainer.createGame()},80)},e.prototype.checkoutMusic=function(){this.music.texture=RES.getRes("music_close_png")},e}(BaseUILayer);__reflect(Home.prototype,"Home");var PopContainer=function(t){function e(){return t.call(this)||this}return __extends(e,t),e.prototype.init=function(){this.touchEnabled=!0,this.touchThrough=!0,console.log("PopContainer已加载")},e}(BaseUILayer);__reflect(PopContainer.prototype,"PopContainer"),window.Main=Main;